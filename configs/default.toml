# ACE Configuration File
# All values can be overridden by environment variables

[database]
# SQLite for local; postgres://user:pass@host/db for pgvector
url = "sqlite:///ace.db"

[embeddings]
# Embedding model for vector retrieval
model = "bge-small"

[retrieval]
# Number of bullets to retrieve per query
top_k = 24

# Lexical weight for hybrid search (0.0-1.0)
lexical_weight = 0.5

# Maximum bullets allowed before auto-refine triggers (0 = disabled)
max_bullets = 2000

[refine]
# Cosine similarity threshold for deduplication (0.0-1.0)
threshold = 0.90

# Minhash Jaccard threshold for near-duplicate detection
minhash_threshold = 0.85

[training]
# Enable regression gating: rollback epochs that regress on held-out eval
gate_on_regression = false

# Maximum allowed regression delta before rollback (0.0-1.0)
# E.g., 0.05 means rollback if any metric drops more than 5%
max_regression_delta = 0.05

# Path to held-out evaluation split (JSONL format)
held_out_path = ""

# Metrics to check for regression (comma-separated)
# Available: mrr, recall, precision, success_rate
regression_metrics = "mrr,recall"

[logging]
# Log level: DEBUG, INFO, WARNING, ERROR
level = "INFO"

# Log format: json or text
format = "json"

[mcp]
# MCP transport: stdio, http, sse
transport = "stdio"

# HTTP port (only if transport=http)
port = 8000

[llm]
# Default LLM provider (openai, anthropic, etc.)
provider = "openai"

# Model name
model = "gpt-4o-mini"

# Temperature for reflection/curation
temperature = 0.0

# Max tokens for LLM responses
max_tokens = 2000
